<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Quiz Party</title>
    <style>
        body,html{margin:0; height:100%; font-family:'Segoe UI', sans-serif;}
        #q-container{height:35%; background:#2c3e50; color:white; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:20px; text-align:center;}
        #category-tag{background:#f1c40f; color:#333; padding:5px 15px; border-radius:20px; font-weight:bold; font-size:0.8rem; margin-bottom:15px; text-transform:uppercase;}
        #question{font-size:1.4em; max-width:800px; line-height:1.4;}
        #g{height:65%; display:flex; flex-wrap:wrap;}
        .opt-btn{width:50%; height:50%; border:none; color:white; font-size:1.2em; padding:10px; cursor:pointer; transition:opacity 0.2s;}
        .opt-btn:active{opacity:0.8;}
        @media (max-width: 600px) { .opt-btn{width:100%; height:25%;} }
    </style>
</head>
<body>
    <div id="q-container">
        <div id="category-tag">Loading...</div>
        <div id="question">Fetching data from offline database...</div>
    </div>
    <div id="g">
        <button id="p0" class="opt-btn" style="background:#e74c3c" onclick="c(0)"></button>
        <button id="p1" class="opt-btn" style="background:#3498db" onclick="c(1)"></button>
        <button id="p2" class="opt-btn" style="background:#f1c40f; color:#333" onclick="c(2)"></button>
        <button id="p3" class="opt-btn" style="background:#2ecc71" onclick="c(3)"></button>
    </div>

    <script>
        let a = -1;

        async function loadQuestion(){
            // Fetch ANY random question (no subject specified)
            try {
                let response = await fetch('/api/get_question');
                let data = await response.json();
                
                // Update the UI
                document.getElementById('category-tag').innerText = data.subject || "General";
                document.getElementById('question').innerText = data.question;
                
                // Update Buttons
                for(let i=0; i<4; i++) {
                    document.getElementById('p'+i).innerText = data.options[i];
                }
                a = data.answer;
            } catch(e) {
                document.getElementById('question').innerText = "Error: Check if questions.csv exists in build folder!";
            }
        }

        function c(i){
            if(i === a) { 
                alert("ðŸŽ‰ Correct!"); 
                loadQuestion(); 
            } else { 
                alert("âŒ Wrong Answer!"); 
            }
        }
        
        // Load first question on start
        loadQuestion();
    </script>
</body>
</html>